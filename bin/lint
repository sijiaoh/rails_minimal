#!/usr/bin/env bash

set -eu

while (($# > 0)); do
  case $1 in
  -a | --autocorrect)
    AUTOCORRECT=""
    ;;
  -v | --verbose)
    VERBOSE=""
    ;;
  -x | --debug)
    set -x
    ;;
  esac
  shift
done

function exec() {
  if [ -n "${VERBOSE+x}" ]; then
    "$@"
  else
    "$@" >/dev/null
  fi
}

exec bundle exec rubocop ${AUTOCORRECT+--autocorrect}
exec bundle exec htmlbeautifier ${AUTOCORRECT---lint-only} app/views/**/*.html.erb
exec bundle exec erblint . ${AUTOCORRECT+--autocorrect}
exec npx prettier ${AUTOCORRECT+--write} ${AUTOCORRECT---check} .

echo "Lint passed."
